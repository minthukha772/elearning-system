<!DOCTYPE html>
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  xmlns:sec="http://www.thymeleaf.org/thymeleaf-extrasspringsecurity4"
>
  <head>
    <meta charset="utf-8" />
    <!-- <link rel="shortcut icon" type="image/ico" href="http://www.datatables.net/favicon.ico"> -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, minimum-scale=1.0, user-scalable=no"
    />
    <!-- <link rel="stylesheet" type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css"> -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"> -->
    <!-- Important for DropDown -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script> -->
    <link
      rel="stylesheet"
      type="text/css"
      href="css/dataTables.bootstrap5.css"
      th:href="@{/css/dataTables.bootstrap5.css}"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link
      rel="stylesheet"
      type="text/css"
      href="css/shCore.css"
      th:href="@{/css/shCore.css}"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="css/demo.css"
      th:href="@{/css/demo.css}"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="css/AT0003_ListofAdmins.css"
      th:href="@{/css/AT0003_ListofAdmins.css}"
    />
    <link rel="stylesheet" th:href="@{/css/bootstrap.css}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

    <title>Pyinnyar Subuu</title>

    <link rel="icon" type="image/x-icon" href="/images/fav.png" />
    <link rel="icon" type="image/x-icon" href="/images/fav.png" />

    <script
      type="text/javascript"
      language="javascript"
      src="https://code.jquery.com/jquery-3.5.1.js"
      th:src="@{https://code.jquery.com/jquery-3.5.1.js}"
    ></script>

    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
    <!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script> -->

    <!-- <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script> -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js}"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>

    <script
      type="text/javascript"
      language="javascript"
      src="js/jquery.dataTables.js"
      th:src="@{/js/jquery.dataTables.js}"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="js/dataTables.bootstrap5.js"
      th:src="@{/js/dataTables.bootstrap5.js}"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="js/shCore.js"
      th:src="@{/js/shCore.js}"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="js/demo.js"
      th:src="@{/js/demo.js}"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      class="init"
      th:inline="javascript"
    >
      /*<![CDATA[*/
      $(document).ready(function () {
        var t = $("#example").DataTable({
          columnDefs: [
            {
              searchable: false,
              orderable: false,
            },
          ],
          order: [1, "asc"],
          dom: '<"top"f>rt<"bottom"lp><"clear">', // Positions table elements
          // "language": {
          //     "search": "_INPUT_",            // Removes the 'Search' field label
          //     "searchPlaceholder": "Search"   // Placeholder for the search box
          // }
          dom: "lrtip",
          // It's work
          // initComplete: function () {
          //     this.api().columns(4).every(function () {
          //         var column = this;
          //         var select = $('<select><option value="">All</option></select>')
          //             .appendTo($(column.footer()).empty())
          //             .on('change', function () {
          //                 var val = $.fn.dataTable.util.escapeRegex(
          //                     $(this).val()
          //                 );

          //                 column
          //                     .search(val ? '^' + val + '$' : '', true, false)
          //                     .draw();
          //             });

          //         column.data().unique().sort().each(function (d, j) {
          //             select.append('<option value="' + d + '">' + d + '</option>')
          //         });
          //     });
          // }
        });

        $("#mySearchButton").on("keyup click", function () {
          t.search($("#mySearchText").val()).draw();
        });

        // var selectedValue=$("#account_status").val();
        // console.log("Selected Value"+selectedValue);
        // t.columns(4).search( selectedValue ).draw();

        $("#account_status").on("change", function () {
          t.search(this.value).draw();
        });
        // $('#account_status select').on('change', function () {
        //     var val = $.fn.dataTable.util.escapeRegex(
        //         $(this).val()
        //     );

        //     this
        //         .search(val ? '^' + val + '$' : '', true, false)
        //         .draw();
        // });

        // $('#example').DataTable({

        // });

        // $("#mySearchText").keyup(function() {t.fnFilter(this.value);});
        // $('#mySearchText').keypress(function(){
        //     t.fnFilter( $(this).val() );
        // });

        // $('#mySearchText').keypress(function(){
        //     t.fnFilter( this.value);
        // });

        // Yay it's ok
        $("#mySearchText").on("keyup search input paste cut", function () {
          t.search(this.value).draw();
        });
        //Yay it's ok

        t.on("order.dt search.dt", function () {
          t.column(0, { search: "applied", order: "applied" })
            .nodes()
            .each(function (cell, i) {
              cell.innerHTML = i + 1;
            });
        }).draw();
      });

      // $(document).ready(function () {
      //     var t = $('#example').DataTable({
      //         "columnDefs": [{
      //             "searchable": false,
      //             "orderable": false,
      //             "targets": 0
      //         }],
      //         "order": [
      //             [ 1, 'asc' ]
      //         ]
      //     });

      //     t.on('order.dt search.dt', function () {
      //         t.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
      //             cell.innerHTML = i + 1;
      //         });
      //     }).draw();
      // });

      // dTable = $('#example').DataTable({
      //     "bLengthChange": false, // this gives option for changing the number of records shown in the UI table
      //     "lengthMenu": [4], // 4 records will be shown in the table
      //     "columnDefs": [
      //         { "className": "dt-center", "targets": "_all" } //columnDefs for align text to center
      //     ],
      //     "dom": "lrtip" //to hide default searchbox but search feature is not disabled hence customised searchbox can be made.
      // });

      // $('#myCustomSearchBox').keyup(function () {
      //     dTable.search($(this).val()).draw();   // this  is for customized searchbox with datatable search feature.
      // });

      //     $('#myCustomSearchBox').keypress(function(){
      //      oTable.fnFilter( $(this).val() );
      //  });

      //     $('#myCustomSearchBox').on( 'keyup', function () {
      //    table.search( this.value ).draw();
      // } );
      // $("#mySearchText").keyup(function() {
      //    dataTable.fnFilter(this.value);
      // });

      // $("#myCustomSearchBox").html($(".dataTables_filter"));

      //TODO if want to use modal for admin register
      // $(document).ready(function(){
      //     $("#addadmin").click(function(){
      //         $("#myModal").modal('show');

      //     });
      // });

      /*]]>*/
    </script>
  </head>

  <body>
    <div style="position: relative">
      <div th:replace="${nav_type}"></div>
      <nav aria-label="breadcrumb" style="--bs-breadcrumb-divider: '>'">
        <ol class="breadcrumb">
          <li class="breadcrumb-item ms-3"><a th:href="@{/admin/top/}">Top</a></li>
          <li class="breadcrumb-item active" aria-current="page">Admin List</li>
        </ol>
      </nav>

      <!-- <div id="mySidebar" class="sidebar" style="float:left;">
                                                                        
                                                                                                <div class="text">
                                                                                                    Menu
                                                                                                </div>
                                                                                                <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
                                                                                                <ul class="main_side">
                                                                                                    <li><a th:href="@{/admin/profile}">Profile</a></li>
                                                                                                    <li> <a href="#" id="1">User List <span class="fas fa-caret-down"></span> </a>
                                                                                                        <ul class="item-show-1">
                                                                                                            <li><a th:href="@{/student-list}">Student List</a></li>
                                                                                                            <li><a th:href="@{/teacher-list}">Teacher List</a></li>
                                                                                                            <li><a th:href="@{/admin-list}"  class="active-link">Admin List</a></li>
                                                                                                        </ul>
                                                                                                    </li>
                                                                                                    <li><a th:href="@{/payment-list}">Payment Record</a></li>
                                                                                                    <li> <a id="2">Course <span class="fas fa-caret-down"></span> </a>
                                                                                                        <ul class="item-show-2">
                                                                                                            <li><a th:href="@{/course-list}">Course List</a></li>
                                                                                                        </ul>
                                                                                                    </li>
                                                                                                    <li><a th:href="@{/review-list}">Review List</a></li>
                                                                                                    <li><a th:href="@{/absence-list}">Absence List</a></li>
                                                                                                    <li><a th:href="@{/}">Log Out</a></li>
                                                                                                </ul>
                                                                                            </div> -->

      <!-- <div id="main" style="margin-left: 250px;"> -->
      <div id="main">
        <!-- <nav class="navbar navbar-expand-lg navbar-light bg-light">
                                                                                                    <div class="container-fluid">
                                                                                                        <div style="justify-content: space-between;">
                                                                                                            <button class="openbtn" onclick="openNav()">☰</button>
                                                                                                            <a class="navbar-brand" href="#">Pyinnyar Subuu</a>
                                                                                                        </div> -->

        <!-- <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                                                                                                        <span class="navbar-toggler-icon"></span>
                                                                                                      </button> -->
        <!-- <div class="header_img">
                                                                                                        <img src="images/admin_profile.jpg" th:src="@{/images/admin_profile.jpg}" alt="people-profile" onclick="location.href='/profile'">
                                                                                                    </div>
                                                                                                    </div>
                                                                                                  </nav> -->

        <div class="container-fluid">
          <div class="row">
            <div class="col-md-12">
              <div style="padding-left: 100px; float: right" class="mb-3">
                <button
                  type="button"
                  class="btn btn-primary mb-3 me-3"
                  id="addadmin"
                  th:onclick="|window.location.href='/check_email/register/admin'|"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    fill="currentColor"
                    class="bi bi-person-plus-fill"
                    viewBox="0 0 16 16"
                  >
                    <path
                      d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"
                    />
                    <path
                      fill-rule="evenodd"
                      d="M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5z"
                    />
                  </svg>
                  Add Admin
                </button>
              </div>
            </div>
          </div>
        </div>                                                                                        

        <!-- Modal HTML -->
        <div id="myModal" class="modal" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title fw-bold">New Admin Registration</h5>
                <!-- <button type="button" class="close" data-bs-dismiss="modal">&times;</button> -->
                <button
                  type="button"
                  class="btn-close close"
                  aria-label="Close"
                  data-bs-dismiss="modal"
                ></button>
              </div>
              <div class="modal-body">
                <img
                  src="images/people-profile.png"
                  class="img-fluid img-thumbnail"
                  alt="people-profile"
                />
                <!-- <p th:text="${adminRole}"></p> -->
                <!-- TODO post to register screen -->
                <form
                  id="admin_register"
                  method="post"
                  action="/register"
                  th:object="${adminRegister}"
                >
                  <div class="mb-3">
                    <label for="admin_name" class="col-form-label clabel"
                      >Name:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="admin_name"
                      th:field="*{userName}"
                      required
                    />
                  </div>
                  <div class="mb-3">
                    <label for="admin_email" class="col-form-label clabel"
                      >Email:</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="admin_email"
                      th:field="*{mail}"
                      required
                    />
                  </div>
                  <!-- <input type="text" class="form-control" id="admin_role" th:field="*{}"> -->

                  <input
                    type="hidden"
                    class="form-control"
                    id="admin_role"
                    name="admin_role"
                    th:value="${adminRole}"
                  />
                  <!-- <div class="mb-3"> -->
                  <button
                    type="submit"
                    class="btn btn-primary"
                    style="background-color: #7749f8"
                  >
                    Register
                  </button>
                  <!-- </div> -->
                </form>
              </div>
              <!-- <div class="modal-footer">
                                                                                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                                                                                <button type="button" class="btn btn-primary">Save</button>
                                                                                                            </div> -->
            </div>
          </div>
        </div>

        <div class="container d-none d-md-block d-lg-block d-xl-block">
          <div class="">
            <div class="input-group mb-3">
              <!-- <div class="input-group-prepend" style="width: 25%;">
                                                                                                                <select class="form-select" aria-label=".form-select-sm example" id="account_status"
                                                                                                                style="width: 100%;">
                                                                                                                <option value="">All</option>
                                                                                                                <option value="Registered">Registered</option>
                                                                                                                <option value="Request">Request</option>
                                                                                                                <option value="Suspended">Suspended</option>
                                                                                                            </select>
                                                                                                        </div> -->

              <input
                type="text"
                class="form-control"
                id="mySearchText"
                placeholder="Search in Admin List"
                aria-label="Search in Admin List"
                aria-describedby="mySearchButton"
              />
              <button
                class="btn btn-outline-secondary fw-bold"
                id="mySearchButton"
                type="button"
              >
                Search
              </button>
            </div>
          </div>

          <div class="input-group-prepend mb-3" style="width: 135px">
            <label class="text-muted">Account Status</label>
            <select
              class="form-select"
              aria-label=".form-select-sm example"
              id="account_status"
              style="width: 100%"
            >
              <option value="">ALL</option>
              <!-- <option value="Request">Request</option> -->
              <option value="Registered">REGISTERED</option>
              <option value="Suspended">SUSPENDED</option>
            </select>
          </div>

          <div class="card mb-5">
            <div class="card-body">
              <div class="table-responsive">
                <table
                  id="example"
                  class="table "
                  style="width: 100%"
                >
                  <thead>
                    <tr>
                      <th>No</th>
                      <!-- <th>Name</th> -->
                      <th>Email</th>
                      <!-- <th>Phone Number</th> -->
                      <th>Account Status</th>
                      <th>Registered Date</th>
                      <th>Delete Account</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr th:each="dr,index:${aAllAdminList}">
                      <td></td>
                      <!-- <td
                          th:text="${dr.userName}"
                          style="font-weight: bold"
                        ></td> -->
                      <td th:text="${dr.mail}"></td>

                      <!-- ### Admin Profile link function -->
                      <!-- <td>
                        <b
                        ><a
                        th:href="@{/admin/browse/profile/{id}(id=${dr.accountId})}"
                        th:text="${dr.mail}"
                        style="text-decoration: none"
                        ></a
                        ></b></td> -->
                      <!-- <td th:text="${dr.phoneNo}"></td> -->

                      <td th:text="${dr.accountStatus}" class="accStatus"></td>
                      <td th:text="${dr.registeredDate}"></td>
                      <td>
                        <!-- <a href="#" class="del"  > -->
                          <!-- <button type="button" th:value="${dr.accountId}" class="confirm_del_btn btn-danger btn-sm" style="margin-left:30px">Delete</button> -->
                          <button type="button" th:value="${dr.accountId}" class="confirm_del_btn fa-solid fa-trash-can" style="margin-left:30px" ></button>
                          
                          <script>
                            $(document).ready(function () {
                            $('.confirm_del_btn').click(function (e){
                            e.preventDefault();
                            var uid = $(this).val();

                            // ### Default Alert Notification.

                            // if(confirm("Are you sure you want to delete Admin Account ?"))
                            // {
                            // $.ajax({
                            // url: "/admin/profile/delete/"+uid,
                            // }).done(function () {
                            // //reload page
                            //  location.reload();
                            //   }).fail(function () {
                            //   alert("Something went wrong");
                            //  });
                            // }

                             // ### Default Alert Notification.

                            swal({
                              // title: "Are you sure you want to delete Admin Account ?",
                              text: "Are you sure you want to delete admin account?",
                              icon: "warning",
                              buttons: true,
                              dangerMode: true,
                            })
                            .then((willDelete) => {
                              if (willDelete) 
                              {
                                swal("Account Deleted!" , {
                                  icon: "success", });
                                
                                $.ajax({
                                url: "/admin/profile/delete/"+uid,
                                  }).done(function () {
                                  //reload page
                                  
                                  setTimeout(function () {
                                    location.reload(true);
                                  }, 1000);
                                  // location.reload();
                                  
                                    });
                                
                              } 
                              // else {
                              //   swal("Action Cancelled!");
                              // }
                            });

                            });
                            });
                            
                            const userRole = 'ROLE_ADMIN';
                            
                            </script> 
                        </a>

                        
                      </td>                      
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          </div>
        </div>

        <div class="mobile-view d-block d-md-none d-lg-none d-xl-none">
          <div class="mobile-item card" th:each="dr,index:${aAllAdminList}">
            <div class="card-body text-white">
              <div class="my-2">
                <span class="fw-bold">Account Status -</span>
                <span class="mx-2 accStatus" th:text="${dr.accountStatus}"></span>
              </div>
              <div class="my-2">
                <span class="fw-bold">Registered Date -</span>
                <span class="mx-2 text-center" th:text="${dr.registeredDate}"></span>
              </div>
              <div class="d-flex align-items-center flex-wrap">
                <div class="my-2 mx-2">
                  <i class="fa-solid fa-envelope"></i>
                  <span class="mx-2" th:text="${dr.mail}"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
      </div>
    </div>

    <!-- <div style="margin-top: 60px;"</div></div> -->

    <div th:replace="@{fragments/footer}"></div>

    <script>
      function openNav() {
        document.getElementById("mySidebar").style.width = "250px";
        document.getElementById("main").style.marginLeft = "250px";
        document.getElementById("sidebutton").style.display = "none";
        document.getElementById("mySidebar").style.position = "fixed";
      }

      function closeNav() {
        document.getElementById("mySidebar").style.width = "0";
        document.getElementById("main").style.marginLeft = "0";
        document.getElementById("sidebutton").style.display = "block";
        document.getElementById("sidebutton").style.width = "5px";
      }

      // $(window).scroll(function () {
      //     $('#footer').css('left', '-' + $(window).scrollLeft() + 'px');
      // });

      // $(window).scroll(function () {
      //     var scroll_top = $(this).scrollTop(); // get scroll position top
      //     var height_element_parent = $("#mySidebar").parent().outerHeight(); //get high parent element
      //     var height_element = $("#mySidebar").height(); //get high of elemeneto
      //     var position_fixed_max = height_element_parent - height_element; // get the maximum position of the elemen
      //     var position_fixed = scroll_top < 250 ? 250 - scroll_top : position_fixed_max > scroll_top ? 0 : position_fixed_max - scroll_top;
      //     $("#mySidebar").css("top", position_fixed);
      // });

      var $scrollingDiv = $("#mySidebar");

      $(window).scroll(function () {
        var y = $(this).scrollTop(),
          maxY = $("#footer").offset().top,
          scrollHeight = $scrollingDiv.height();

        if (y < maxY - scrollHeight) {
          $scrollingDiv
            .stop()
            .animate({ marginTop: $(window).scrollTop() + "px" }, "slow");
        }
      });
    </script>

   
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="/js/AT0003_ListofAdminsScreen.js"></script>

    </script>
    <script>
      let td=document.getElementsByClassName('accStatus');
        
        for(let i=0;i<td.length;i++){
          console.log(td[i].innerHTML)
          if(td[i].innerHTML=="REGISTERED"){
              td[i].classList.add('bg-success')
          }
          else if(td[i].innerHTML=="SUSPENDED"){
            td[i].classList.add('bg-info')
          }
          else{
              td[i].classList.add('bg-warning')
          }
      }
      
    </script>

  </body>
</html>
